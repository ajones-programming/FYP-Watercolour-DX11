//
// FX Version: fx_5_0
//
// 1 local buffer(s)
//
cbuffer cbSettings
{
    float   NoiseIntensity = 5;         // Offset:    0, size:    4
}

//
// 4 local object(s)
//
SamplerState samAnisotropic
{
    Filter   = uint(ANISOTROPIC /* 85 */);
    MaxAnisotropy = uint(4);
    AddressU = uint(MIRROR /* 2 */);
    AddressV = uint(MIRROR /* 2 */);
};
Texture2D gInput;
RWTexture2D gOutput;
Texture2D gPerlinNoise;

//
// 1 groups(s)
//
fxgroup
{
    //
    // 2 technique(s)
    //
    technique11 EdgeWobble
    {
        pass P0
        {
            VertexShader = NULL;
            PixelShader = NULL;
            ComputeShader = asm {
                //
                // Generated by Microsoft (R) HLSL Shader Compiler 10.1
                //
                //
                // Buffer Definitions: 
                //
                // cbuffer cbSettings
                // {
                //
                //   float NoiseIntensity;              // Offset:    0 Size:     4
                //      = 0x40a00000 
                //
                // }
                //
                //
                // Resource Bindings:
                //
                // Name                                 Type  Format         Dim      HLSL Bind  Count
                // ------------------------------ ---------- ------- ----------- -------------- ------
                // samAnisotropic                    sampler      NA          NA             s0      1 
                // gInput                            texture  float4          2d             t0      1 
                // gPerlinNoise                      texture  float4          2d             t1      1 
                // gOutput                               UAV  float4          2d             u0      1 
                // cbSettings                        cbuffer      NA          NA            cb0      1 
                //
                //
                //
                // Input signature:
                //
                // Name                 Index   Mask Register SysValue  Format   Used
                // -------------------- ----- ------ -------- -------- ------- ------
                // no Input
                //
                // Output signature:
                //
                // Name                 Index   Mask Register SysValue  Format   Used
                // -------------------- ----- ------ -------- -------- ------- ------
                // no Output
                cs_5_0
                dcl_globalFlags refactoringAllowed | skipOptimization
                dcl_constantbuffer CB0[1], immediateIndexed
                dcl_sampler s0, mode_default
                dcl_resource_texture2d (float,float,float,float) t0
                dcl_resource_texture2d (float,float,float,float) t1
                dcl_uav_typed_texture2d (float,float,float,float) u0
                dcl_input vThreadIDInGroup.x
                dcl_input vThreadID.xy
                dcl_temps 3
                dcl_tgsm_structured g0, 16, 256
                dcl_thread_group 256, 1, 1
                //
                // Initial variable locations:
                //   vThreadIDInGroup.x <- groupThreadID.x; vThreadIDInGroup.y <- groupThreadID.y; vThreadIDInGroup.z <- groupThreadID.z; 
                //   vThreadID.x <- dispatchThreadID.x; vThreadID.y <- dispatchThreadID.y; vThreadID.z <- dispatchThreadID.z
                //
                #line 38 "D:\Files\University\Modules\TM470 Final Year Project\DX11\MyWork\MyProject\Prototype1\FX\EdgeWobble.fx"
                itof r0.xy, vThreadID.xyxx
                resinfo_indexable(texture2d)(float,float,float,float)_uint r0.zw, l(0), t0.zwxy
                utof r0.zw, r0.zzzw
                div r0.xy, r0.xyxx, r0.zwzz  // r0.x <- uv.x; r0.y <- uv.y
                
                #line 39
                itof r0.zw, l(0, 0, 2, 2)
                mul r0.zw, r0.zzzw, r0.xxxy
                itof r1.x, l(0)
                sample_l_indexable(texture2d)(float,float,float,float) r0.zw, r0.zwzz, t1.zwxy, s0, r1.x
                mov r0.zw, r0.zzzw  // r0.z <- sampledArea1.x; r0.w <- sampledArea1.y
                
                #line 40
                itof r1.xy, l(2, 2, 0, 0)
                div r1.xy, r0.xyxx, r1.xyxx
                itof r1.z, l(0)
                sample_l_indexable(texture2d)(float,float,float,float) r1.xy, r1.xyxx, t1.xyzw, s0, r1.z
                mov r1.xy, r1.xyxx  // r1.x <- sampledArea2.x; r1.y <- sampledArea2.y
                
                #line 42
                mov r1.zw, l(-0.000000,-0.000000,-0.500000,-0.500000)
                add r0.zw, r0.zzzw, r1.zzzw
                mul r0.zw, r0.zzzw, cb0[0].xxxx
                resinfo_indexable(texture2d)(float,float,float,float)_uint r1.zw, l(0), t0.zwxy
                utof r1.zw, r1.zzzw
                div r0.zw, r0.zzzw, r1.zzzw
                add r0.xy, r0.zwzz, r0.xyxx
                itof r0.zw, l(0, 0, 5, 5)
                mov r1.zw, l(-0.000000,-0.000000,-0.500000,-0.500000)
                add r1.xy, r1.zwzz, r1.xyxx
                mul r0.zw, r0.zzzw, r1.xxxy
                resinfo_indexable(texture2d)(float,float,float,float)_uint r1.xy, l(0), t0.xyzw
                utof r1.xy, r1.xyxx
                div r0.zw, r0.zzzw, r1.xxxy
                add r0.xy, r0.zwzz, r0.xyxx  // r0.x <- newPosition.x; r0.y <- newPosition.y
                
                #line 43
                itof r0.z, l(0)
                sample_l_indexable(texture2d)(float,float,float,float) r0.xyzw, r0.xyxx, t0.xyzw, s0, r0.z  // r0.x <- sampleColour.x; r0.y <- sampleColour.y; r0.z <- sampleColour.z; r0.w <- sampleColour.w
                
                #line 45
                mov r1.x, vThreadIDInGroup.x
                store_structured g0.x, r1.x, l(0), r0.x
                store_structured g0.x, r1.x, l(4), r0.y
                store_structured g0.x, r1.x, l(8), r0.z
                store_structured g0.x, r1.x, l(12), r0.w
                
                #line 47
                sync_g_t
                
                #line 49
                mov r0.xyzw, vThreadID.xyyy
                mov r1.x, vThreadIDInGroup.x
                ld_structured r2.x, r1.x, l(0), g0.xxxx
                ld_structured r2.y, r1.x, l(4), g0.xxxx
                ld_structured r2.z, r1.x, l(8), g0.xxxx
                ld_structured r2.w, r1.x, l(12), g0.xxxx
                store_uav_typed u0.xyzw, r0.xyzw, r2.xyzw
                
                #line 51
                ret 
                // Approximately 45 instruction slots used
                            
            };
        }

    }

    technique11 ReturnEdgeWobble
    {
        pass P0
        {
            VertexShader = NULL;
            PixelShader = NULL;
            ComputeShader = asm {
                //
                // Generated by Microsoft (R) HLSL Shader Compiler 10.1
                //
                //
                // Resource Bindings:
                //
                // Name                                 Type  Format         Dim      HLSL Bind  Count
                // ------------------------------ ---------- ------- ----------- -------------- ------
                // gInput                            texture  float4          2d             t0      1 
                // gOutput                               UAV  float4          2d             u0      1 
                //
                //
                //
                // Input signature:
                //
                // Name                 Index   Mask Register SysValue  Format   Used
                // -------------------- ----- ------ -------- -------- ------- ------
                // no Input
                //
                // Output signature:
                //
                // Name                 Index   Mask Register SysValue  Format   Used
                // -------------------- ----- ------ -------- -------- ------- ------
                // no Output
                cs_5_0
                dcl_globalFlags refactoringAllowed | skipOptimization
                dcl_resource_texture2d (float,float,float,float) t0
                dcl_uav_typed_texture2d (float,float,float,float) u0
                dcl_input vThreadIDInGroup.y
                dcl_input vThreadID.xy
                dcl_temps 3
                dcl_tgsm_structured g0, 16, 256
                dcl_thread_group 1, 256, 1
                //
                // Initial variable locations:
                //   vThreadIDInGroup.x <- groupThreadID.x; vThreadIDInGroup.y <- groupThreadID.y; vThreadIDInGroup.z <- groupThreadID.z; 
                //   vThreadID.x <- dispatchThreadID.x; vThreadID.y <- dispatchThreadID.y; vThreadID.z <- dispatchThreadID.z
                //
                #line 57 "D:\Files\University\Modules\TM470 Final Year Project\DX11\MyWork\MyProject\Prototype1\FX\EdgeWobble.fx"
                mov r0.xy, vThreadID.xyxx
                resinfo_indexable(texture2d)(float,float,float,float)_uint r0.zw, l(0), t0.zwxy
                mov r1.xy, l(1,1,0,0)
                ineg r1.xy, r1.xyxx
                iadd r0.zw, r0.zzzw, r1.xxxy
                umin r0.xy, r0.zwzz, r0.xyxx
                mov r0.zw, l(0,0,0,0)
                ld_indexable(texture2d)(float,float,float,float) r0.xyzw, r0.xyzw, t0.xyzw  // r0.x <- sampleColour.x; r0.y <- sampleColour.y; r0.z <- sampleColour.z; r0.w <- sampleColour.w
                
                #line 58
                mov r1.x, vThreadIDInGroup.y
                store_structured g0.x, r1.x, l(0), r0.x
                store_structured g0.x, r1.x, l(4), r0.y
                store_structured g0.x, r1.x, l(8), r0.z
                store_structured g0.x, r1.x, l(12), r0.w
                
                #line 59
                sync_g_t
                
                #line 60
                mov r0.xyzw, vThreadID.xyyy
                mov r1.x, vThreadIDInGroup.y
                ld_structured r2.x, r1.x, l(0), g0.xxxx
                ld_structured r2.y, r1.x, l(4), g0.xxxx
                ld_structured r2.z, r1.x, l(8), g0.xxxx
                ld_structured r2.w, r1.x, l(12), g0.xxxx
                store_uav_typed u0.xyzw, r0.xyzw, r2.xyzw
                
                #line 61
                ret 
                // Approximately 22 instruction slots used
                            
            };
        }

    }

}

